(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{6980:function(e,t,s){Promise.resolve().then(s.bind(s,488))},488:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),n=s(9376),i=s(9501),c=s(2496),l=s(9064);function d(){let e=(0,n.useParams)().token,[t,s]=(0,a.useState)(null),[d,o]=(0,a.useState)(!0),[m,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(null),{register:f,handleSubmit:p,watch:j,setValue:y,formState:{errors:b}}=(0,i.cI)();(0,a.useEffect)(()=>{N()},[e]);let N=async()=>{try{let t=await fetch("/api/intake/".concat(e)),r=await t.json();if(!r.success){h(r.error||"Failed to load intake form");return}s(r.data),r.data.clientData&&Object.entries(r.data.clientData).forEach(e=>{let[t,s]=e;y(t,s)})}catch(e){console.error("Error fetching intake data:",e),h("Failed to load intake form")}finally{o(!1)}},v=async t=>{try{await fetch("/api/intake/".concat(e,"/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formData:t})})}catch(e){console.error("Error saving progress:",e)}},g=async s=>{if(t){u(!0);try{let r=await fetch("/api/intake/".concat(e,"/submit"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({intakeId:t.intakeId,formData:s,clientInfo:{name:s.clientName||"",email:s.clientEmail||""}})}),a=await r.json();a.success?(l.ZP.success("Form submitted successfully!"),await N()):l.ZP.error(a.error||"Failed to submit form")}catch(e){console.error("Error submitting form:",e),l.ZP.error("Failed to submit form")}finally{u(!1)}}};(0,a.useEffect)(()=>{if(!t||"submitted"===t.status)return;let e=j(),s=setInterval(()=>{Object.keys(e).length>0&&v(e)},3e4);return()=>clearInterval(s)},[t,j]);let k=e=>{var t,s,a;let n={...f(e.name,{required:!!e.required&&"".concat(e.label," is required")}),className:"textarea"===e.type?"form-textarea":"form-input",placeholder:e.placeholder||""};switch(e.type){case"textarea":return(0,r.jsx)("textarea",{...n,rows:4});case"select":return(0,r.jsxs)("select",{...n,className:"form-select",children:[(0,r.jsx)("option",{value:"",children:"Select an option"}),null===(t=e.options)||void 0===t?void 0:t.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]});case"radio":return(0,r.jsx)("div",{className:"space-y-2",children:null===(s=e.options)||void 0===s?void 0:s.map(t=>(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{...f(e.name,{required:!!e.required&&"".concat(e.label," is required")}),type:"radio",value:t,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:t})]},t))});case"checkbox":return(0,r.jsx)("div",{className:"space-y-2",children:null===(a=e.options)||void 0===a?void 0:a.map(t=>(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{...f("".concat(e.name,".").concat(t)),type:"checkbox",className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:t})]},t))});default:return(0,r.jsx)("input",{...n,type:e.type})}};if(d)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)(c.Z,{})});if(x)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)("div",{className:"max-w-md w-full",children:(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"card-content text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Form"}),(0,r.jsx)("p",{className:"text-red-600",children:x})]})})})});if(!t)return null;let w="submitted"===t.status;return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto px-4",children:[(0,r.jsxs)("div",{className:"mb-8 text-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t.serviceName}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:t.serviceDescription}),w&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-green-800 font-medium",children:"âœ“ Form submitted successfully! We'll review your information and get back to you soon."})})]}),(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-content",children:(0,r.jsxs)("form",{onSubmit:p(g),className:"space-y-6",children:[t.formFields.map(e=>{var t;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.label,e.required&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:e.description}),k(e),b[e.name]&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-1",children:null===(t=b[e.name])||void 0===t?void 0:t.message})]},e.id)}),(0,r.jsx)("div",{className:"pt-6 border-t",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Progress is automatically saved"}),!w&&(0,r.jsx)("button",{type:"submit",disabled:m,className:"btn btn-primary",children:m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{size:"sm"}),(0,r.jsx)("span",{className:"ml-2",children:"Submitting..."})]}):"Submit Form"})]})})]})})}),(0,r.jsx)("div",{className:"mt-8 text-center",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Powered by Smart Forms AI"})})]})})}},2496:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(7437);function a(e){let{size:t="md"}=e;return(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("div",{className:"".concat({sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[t]," animate-spin rounded-full border-2 border-gray-300 border-t-primary-600")})})}}},function(e){e.O(0,[64,853,971,117,744],function(){return e(e.s=6980)}),_N_E=e.O()}]);